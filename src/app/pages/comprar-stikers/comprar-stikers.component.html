<section class="comprar">

  <h2>Comprar Stikers</h2>

  <!-- PASO 1 -->
  <div *ngIf="step === 1" class="panel">

    <h3>Selecciona tus stikers</h3>

    <!-- Barra de bÃºsqueda -->
    <input
      class="buscador"
      placeholder="Buscar nÃºmero (0000 - 9999)"
      [(ngModel)]="busqueda"
    >

    <!-- Compra aleatoria -->
    <div class="aleatorio">
      <input
        type="number"
        min="1"
        [(ngModel)]="cantidadAleatoria"
      >
      <button class="btn-outline" (click)="seleccionarAleatorios()">
        Asignar al azar
      </button>
    </div>

    <div class="grid">
      <button
        *ngFor="let s of stikersFiltrados"
        class="stiker"
        [class.selected]="s.estado === 'seleccionado'"
        [class.ocupado]="s.estado === 'ocupado'"
        (click)="toggleStiker(s)"
        [title]="s.estado === 'ocupado' ? 'No disponible' : ''"
      >
        <div class="stiker-number">{{ s.numeroA }}</div>
        <div class="stiker-number secondary">{{ s.numeroB }}</div>
      </button>
    </div>

    <div class="resumen">
      <p>{{ seleccionados.length }} stikers seleccionados</p>
      <button
        class="btn-primary"
        [disabled]="seleccionados.length === 0"
        (click)="nextStep()"
      >
        Continuar
      </button>
    </div>
  </div>

  <!-- PASO 2 -->
  <div *ngIf="step === 2" class="panel">
    <h3>Datos del comprador</h3>

    <form>
      <input placeholder="Nombre completo" [(ngModel)]="cliente.nombre" name="nombre">
      <input placeholder="CÃ©dula" [(ngModel)]="cliente.cedula" name="cedula">
      <input placeholder="TelÃ©fono" [(ngModel)]="cliente.telefono" name="telefono">
      <input placeholder="Correo electrÃ³nico" [(ngModel)]="cliente.email" name="email">
    </form>

    <div class="acciones">
      <button class="btn-outline" (click)="prevStep()">Volver</button>
      <button class="btn-primary" (click)="nextStep()">Ir a pago</button>
    </div>
  </div>

  <!-- PASO 3 -->
  <div *ngIf="step === 3" class="panel pago">
    <h3>Pasarela de pago</h3>

    <p>Total a pagar</p>
    <strong>${{ total }}</strong>

    <div *ngIf="procesandoPago" class="loader">
      Procesando pago...
    </div>

    <div *ngIf="!procesandoPago" class="acciones">
      <button class="btn-outline" (click)="prevStep()">Volver</button>
      <button class="btn-primary" (click)="simularPago()">
        Pagar ahora
      </button>
    </div>
  </div>

  <!-- PASO 4 -->
  <div *ngIf="step === 4" class="panel confirmacion">
    <h3>Compra exitosa ðŸŽ‰</h3>

    <p>Gracias <strong>{{ cliente.nombre }}</strong></p>

    <ul>
      <li *ngFor="let s of seleccionados">
        {{ s.numeroA }} - {{ s.numeroB }}
      </li>
    </ul>

    <p class="total">Total pagado: ${{ total }}</p>

    <div class="acciones-finales">
      <a routerLink="/" class="btn-outline">Volver al inicio</a>
      <button class="btn-primary" (click)="step = 1">Comprar mÃ¡s</button>
    </div>
  </div>

</section>
